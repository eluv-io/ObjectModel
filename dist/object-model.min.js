// ObjectModel v4.3.1 - http://objectmodel.js.org
// MIT License - Sylvain Pollet-Villard
const t=Object.prototype,e=Object.getPrototypeOf,n=Object.setPrototypeOf,r=(e,n)=>t.hasOwnProperty.call(e,n),i=(t,e)=>e instanceof t,o=t=>"function"==typeof t,s=t=>t&&"object"==typeof t,a=t=>"string"==typeof t,l=n=>s(n)&&e(n)===t,c=t=>t&&o(t[Symbol.iterator]),u=(t,e)=>new Proxy(t,e),f=(t,e={})=>{for(let n in e)if(l(e[n])){const r={};f(r,t[n]),f(r,e[n]),t[n]=r}else t[n]=e[n];return t},p=(t,e,n,r=!1)=>{Object.defineProperty(t,e,{value:n,enumerable:r,writable:!0,configurable:!0})},h=(t,e,r)=>{t.prototype=Object.assign(Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r),n(t,e)},d=Symbol(),g=Symbol(),y=Symbol(),m=Symbol(),v=(t,e,r,o,s,a)=>{const l=function(t=l.default,e){return a&&!i(l,this)?new l(t):(o&&(t=o(t,l,this)),e===g||x(l,t)?s&&e!==m?u(t,s(l)):t:void 0)};return r&&h(l,r),n(l,e.prototype),l.constructor=e,l.definition=t,l.assertions=[...l.assertions],p(l,"errors",[]),delete l.name,l},b=(t,e,n)=>i(e,t)?t:s(t)||o(t)||void 0===t?(f(n,e.default),e.parentClass&&f(t,new e.parentClass(t)),f(n,t),n):t,$=(t,e,n)=>(h(t,e,n),t.assertions.push(...e.assertions),t),S=(t,e,n,r,i)=>{t.push({expected:e,received:n,path:r,message:i})},w=(e,n=e.errorCollector)=>{const r=e.errors.length;if(r>0){const r=e.errors.map((e=>{var n;return e.message||(e.message="expecting "+(e.path?e.path+" to be ":"")+P(e.expected)+", got "+(null!=e.received?(n=e.received,t.toString.call(n).match(/\s([a-zA-Z]+)/)[1]+" "):"")+k(e.received)),e}));e.errors.length=0,n.call(e,r)}return r},O=t=>t&&e(t)&&i(K,e(t).constructor),j=t=>{if(l(t)){t={};for(let e in t)t[e]=j(t[e])}else{if(!Array.isArray(t))return[t];if(1===t.length)return[t[0],void 0,null]}return t},P=(t,e)=>{const n=j(t).map((t=>k(t,e)));return n.length>1?n.join(" or "):n[0]},A=(t,e=[])=>(e.length>0&&(t=[].concat(t,...[].concat(e)).filter(((t,e,n)=>n.indexOf(t)===e))),t),x=(t,e)=>(t[d](e,null,t.errors,[],!0),!w(t)),C=(t,e,n,r,o,s)=>{const a=o.indexOf(e);if(-1!==a&&-1!==o.indexOf(e,a+1))return t;if(Array.isArray(e)&&1===e.length&&null!=t&&(e=e[0]),i(K,e))s&&(t=N(t,e)),e[d](t,n,r,o.concat(e));else if(l(e))for(let i in e){const a=t?t[i]:void 0;C(a,e[i],M(n,i),r,o,s)}else{if(j(e).some((e=>R(t,e,n,o))))return s?N(t,e):t;S(r,e,t,n)}return t},R=(t,e,n,r,s)=>{if(e===H)return!0;if(null==t)return t===e;if(l(e)||i(K,e)){const i=[];return C(t,e,n,i,r,s),!i.length}return i(RegExp,e)?e.test(t):e===Number||e===Date?t.constructor===e&&!isNaN(t):t===e||o(e)&&i(e,t)||t.constructor===e},F=(t,e,n,r=e.errors)=>{for(let i of e.assertions){let s;try{s=i.call(e,t)}catch(t){s=t}if(!0!==s){const a=o(i.description)?i.description:(t,e)=>`assertion "${i.description}" returned ${k(t)} for ${n?n+" =":"value"} ${k(e)}`;S(r,i,t,n,a.call(e,s,t,n))}}},k=(e,n=[])=>{if(n.length>15||n.includes(e))return"...";if(null==e)return String(e);if(a(e))return`"${e}"`;if(i(K,e))return e.toString(n);if(n.unshift(e),o(e))return e.name||e.toString();if(i(Map,e)||i(Set,e))return k([...e]);if(Array.isArray(e))return`[${e.map((t=>k(t,n))).join(", ")}]`;if(e.toString&&e.toString!==t.toString)return e.toString();if(s(e)){const t=Object.keys(e),r="\t".repeat(n.length);return`{${t.map((t=>`\n${r+t}: ${k(e[t],[...n])}`)).join(", ")} ${t.length?`\n${r.slice(1)}`:""}}`}return String(e)},M=(t,e)=>t?t+"."+e:e,E=(t,e,n,i,o,s,a)=>{const l=M(n,o),c=t.conventionForPrivate(o),u=t.conventionForConstant(o),f=r(i,o),p=f&&Object.getOwnPropertyDescriptor(i,o);o in e&&(c&&!s||u&&void 0!==i[o])&&D(`modify ${c?"private":"constant"} property ${o}`,t),a(),r(e,o)&&C(i[o],e[o],l,t.errors,[]),F(i,t,l);const h=t.errors.length;return h&&(f?Object.defineProperty(i,o,p):delete i[o],w(t)),!h},D=(t,e)=>{e.errors.push({message:"cannot "+t})},N=(t,e=[])=>{if(!t||l(e)||i(_,e)||O(t))return t;const n=j(e),r=[];for(let e of n)i(K,e)&&!i(_,e)&&e.test(t)&&r.push(e);return 1===r.length?new r[0](t,g):(r.length>1&&console.warn(`Ambiguous model for value ${k(t)}, could be ${r.join(" or ")}`),t)},T=(t,e,n,i)=>({get(s,c){if(c===y)return s;if(!a(c))return Reflect.get(s,c);const f=M(n,c),p=r(e,c),h=e[c];if(!i&&p&&t.conventionForPrivate(c))return D(`access to private property ${f}`,t),void w(t);let d=s[c];return p&&d&&r(s,c)&&!l(h)&&!O(d)&&Reflect.set(s,c,d=N(d,h)),o(d)&&"constructor"!==c&&!i?u(d,{apply(t,e,n){i=!0;const r=Reflect.apply(t,e,n);return i=!1,r}}):(l(h)&&!d&&(s[c]=d={}),((t,e,n,r,i)=>l(n)?u(t,T(e,n,r,i)):N(t,n))(d,t,h,f,i))},set:(r,o,s)=>E(t,e,n,r,o,i,(()=>Reflect.set(r,o,N(s,e[o])))),deleteProperty:(r,o)=>E(t,e,n,r,o,i,(()=>Reflect.deleteProperty(r,o))),defineProperty:(r,o,s)=>E(t,e,n,r,o,i,(()=>Reflect.defineProperty(r,o,s))),has:(n,r)=>Reflect.has(n,r)&&Reflect.has(e,r)&&!t.conventionForPrivate(r),ownKeys:n=>Reflect.ownKeys(n).filter((n=>Reflect.has(e,n)&&!t.conventionForPrivate(n))),getOwnPropertyDescriptor(n,r){let i;return t.conventionForPrivate(r)||(i=Object.getOwnPropertyDescriptor(e,r),void 0!==i&&(i.value=n[r])),i}});function K(t){return l(t)?new z(t):new _(t)}function _(t){return v(t,_)}function z(t){return v(t,z,Object,b,(e=>T(e,t)),!0)}Object.assign(K.prototype,{name:"Model",assertions:[],conventionForConstant:t=>t.toUpperCase()===t,conventionForPrivate:t=>"_"===t[0],toString(t){return r(this,"name")?this.name:P(this.definition,t)+((e=this.assertions).length?`(${e.map((t=>t.name||t.description||t))})`:"");var e},as(t){return p(this,"name",t),this},defaultTo(t){return this.default=t,this},[d](t,e,n,r){C(t,this.definition,e,n,r),F(t,this,e,n)},test(t,n){let i=this;for(;!r(i,"errorCollector");)i=e(i);const o=i.errorCollector;let s;return i.errorCollector=t=>{s=!0,n&&n.call(this,t)},new this(t),i.errorCollector=o,!s},errorCollector(t){const e=new TypeError(t.map((t=>t.message)).join("\n"));throw e.stack=e.stack.replace(/\n.*object-model(.|\n)*object-model.*/,""),e},assert(t,e=k(t)){return p(t,"description",e),this.assertions=this.assertions.concat(t),this}}),K.CHECK_ONCE=m,h(_,K,{extend(...t){const e=$(new _(A(this.definition,t)),this);for(let n of t)i(_,n)&&e.assertions.push(...n.assertions);return e}}),h(z,K,{defaultTo(t){const e=this.definition;for(let n in t)r(e,n)&&(t[n]=C(t[n],e[n],n,this.errors,[],!0));return w(this),this.default=t,this},toString(t){return k(this.definition,t)},extend(...t){const n={...this.definition},r={...this.prototype},a={...this.default},l=[];for(let e of t)i(K,e)&&(f(n,e.definition),f(a,e.default),l.push(...e.assertions)),o(e)&&f(r,e.prototype),s(e)&&f(n,e);const c=$(new z(n),this,r).defaultTo(a);return c.assertions=[...this.assertions,...l],e(this)!==z.prototype&&(c.parentClass=this),c},[d](t,e,n,r,i){s(t)?C(t[y]||t,this.definition,e,n,r,i):S(n,this,t,e),F(t,this,e,n)}});const H=u(_(),{apply(t,e,[n]){const r=Object.create(H);return r.definition=n,r}});H.definition=H,H.toString=()=>"Any",H.remaining=function(t){this.definition=t},h(H.remaining,H,{toString(){return"..."+P(this.definition)}}),H[Symbol.iterator]=function*(){yield new H.remaining(this.definition)};const U=(t,e,n,i,s,a,l)=>v(n,e,t,i,(e=>Object.assign({getPrototypeOf:()=>e.prototype,get(n,i){if(i===y)return n;const l=n[i];return o(l)?u(l,{apply(o,l,c){if(r(a,i)){const[r,l=c.length-1,u]=a[i];for(let n=r;n<=l;n++){const r=u?u(n):e.definition;c[n]=C(c[n],r,`${t.name}.${i} arguments[${n}]`,e.errors,[],!0)}if(e.assertions.length>0){const t=s(n);o.apply(t,c),F(t,e,`after ${i} mutation`)}w(e)}return o.apply(n,c)}}):l}},l)));function W(t){const e=U(Array,W,t,(t=>Array.isArray(t)?t.map((t=>N(t,e.definition))):t),(t=>[...t]),{copyWithin:[],fill:[0,0],pop:[],push:[0],reverse:[],shift:[],sort:[],splice:[2],unshift:[0]},{set:(t,n,r)=>Z(e,t,n,r,((t,e)=>t[n]=e),!0),deleteProperty:(t,n)=>Z(e,t,n,void 0,(t=>delete t[n]))});return e}h(W,K,{toString(t){return"Array of "+P(this.definition,t)},[d](t,e,n,r){Array.isArray(t)?(t[y]||t).forEach(((t,i)=>C(t,this.definition,`${e||"Array"}[${i}]`,n,r))):S(n,this,t,e),F(t,this,e,n)},extend(...t){return $(new W(A(this.definition,t)),this)}});const Z=(t,e,n,r,i,o)=>{const s=`Array[${n}]`;+n>=0&&(o||n in e)&&(r=C(r,t.definition,s,t.errors,[],!0));const a=[...e];i(a),F(a,t,s);const l=!w(t);return l&&i(e,r),l};function q(...t){return v({arguments:t},q,Function,null,(t=>({getPrototypeOf:()=>t.prototype,get:(t,e)=>e===y?t:t[e],apply(e,n,r){const o=t.definition,s=o.arguments.find((t=>i(H.remaining,t))),a=s?Math.max(r.length,o.arguments.length-1):o.arguments.length;for(let e=0;e<a;e++){const n=s&&e>=o.arguments.length-1?s.definition:o.arguments[e];r[e]=C(r[e],n,`arguments[${e}]`,t.errors,[],!0)}let l;return F(r,t,"arguments"),t.errors.length||(l=Reflect.apply(e,n,r),"return"in o&&(l=C(l,o.return,"return value",t.errors,[],!0))),w(t),l}})))}function B(t,e){const n=t=>0===t?r.definition.key:r.definition.value,r=U(Map,B,{key:t,value:e},(t=>c(t)?new Map([...t].map((t=>t.map(((t,e)=>N(t,n(e))))))):t),(t=>new Map(t)),{set:[0,1,n],delete:[],clear:[]});return r}function G(t){const e=U(Set,G,t,(t=>c(t)?new Set([...t].map((t=>N(t,e.definition)))):t),(t=>new Set(t)),{add:[0,0],delete:[],clear:[]});return e}h(q,K,{toString(t=[]){let e=`Function(${this.definition.arguments.map((e=>P(e,[...t]))).join(", ")})`;return"return"in this.definition&&(e+=" => "+P(this.definition.return,t)),e},return(t){return this.definition.return=t,this},extend(t,e){const n=this.definition.arguments,r=t.map(((e,r)=>A(r in n?n[r]:[],t[r]))),i=A(this.definition.return,e);return $(new q(...r).return(i),this)},[d](t,e,n){o(t)||S(n,"Function",t,e)}}),h(B,K,{toString(t){return`Map of ${P(this.definition.key,t)} : ${P(this.definition.value,t)}`},[d](t,e,n,r){if(i(Map,t)){e=e||"Map";for(let[i,o]of t)C(i,this.definition.key,`${e} key`,n,r),C(o,this.definition.value,`${e}[${k(i)}]`,n,r)}else S(n,this,t,e);F(t,this,e,n)},extend(t,e){return $(new B(A(this.definition.key,t),A(this.definition.value,e)),this)}}),h(G,K,{toString(t){return"Set of "+P(this.definition,t)},[d](t,e,n,r){if(i(Set,t))for(let i of t.values())C(i,this.definition,`${e||"Set"} value`,n,r);else S(n,this,t,e);F(t,this,e,n)},extend(...t){return $(new G(A(this.definition,t)),this)}});export{H as Any,W as ArrayModel,_ as BasicModel,q as FunctionModel,B as MapModel,K as Model,z as ObjectModel,G as SetModel};
//# sourceMappingURL=object-model.min.js.map
